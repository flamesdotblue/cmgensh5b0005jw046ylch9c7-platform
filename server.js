import { createServer } from 'node:http'; import { createReadStream } from 'node:fs'; import { stat } from 'node:fs/promises'; import { extname, join, resolve } from 'node:path';
const port = 8000; const root = resolve('.'); const mime = { '.html':'text/html; charset=utf-8','.css':'text/css; charset=utf-8','.js':'application/javascript; charset=utf-8','.json':'application/json; charset=utf-8','.png':'image/png','.jpg':'image/jpeg','.jpeg':'image/jpeg','.gif':'image/gif','.svg':'image/svg+xml','.ico':'image/x-icon'};
createServer(async (req,res)=>{ try{ let urlPath = decodeURI((req.url||'/').split('?')[0]); if(urlPath==='/') urlPath='/index.html'; const filePath = join(root, urlPath); const st = await stat(filePath); if(st.isDirectory()){ res.writeHead(403); res.end('Forbidden'); return; } const ext = extname(filePath); res.writeHead(200, {'Content-Type': mime[ext] || 'application/octet-stream'}); createReadStream(filePath).pipe(res); } catch(e){ res.writeHead(404); res.end('Not found'); } }).listen(port, ()=> console.log(`VibeFeed static server http://localhost:${port}`));
